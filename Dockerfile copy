# Dockerfile
FROM python:3.12-slim

# OS deps
RUN apt-get update && apt-get install -y --no-install-recommends \
    build-essential cmake g++ git curl wget ca-certificates \
 && rm -rf /var/lib/apt/lists/*

WORKDIR /app

# Copy your project
COPY . /app

# Python deps
RUN pip install --no-cache-dir \
    pandas scikit-learn matplotlib joblib \
    llama-cpp-python

# Entry
COPY entrypoint.sh /usr/local/bin/safety-agent
RUN chmod +x /usr/local/bin/safety-agent

# Make src importable
ENV PYTHONPATH=/app

# Default agent version (override with -e AGENT_VERSION=v1)
ENV AGENT_VERSION=v2
# Default model alias (override with -e LLM_MODEL_ALIAS=â€¦ or mount path)
ENV LLM_MODEL_ALIAS=llama2

# Let users just pass a prompt
ENTRYPOINT ["safety-agent"]
